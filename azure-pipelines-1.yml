trigger:
  branches:
    include:
      - Treatsc2_js_test 

pool:
 vmImage: 'ubuntu-latest' 

 variables:
 repositoryName: '<target repository name>'

 steps:
 - task: Docker@2
 inputs:
 containerRegistry: '<docker connection>'
 repository: $(repositoryName)
 command: 'buildAndPush'
 Dockerfile: '**/Dockerfile'


steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '16.x' 


  - script: |
      npm install
    displayName: 'Install Dependencies'


  - script: |
      echo "Running Node Tests..."
      node nodeTest.js  # Ensure nodeTest.js exists and is configured correctly
    displayName: 'Run Node Tests'

  - task: PublishTestResults@2
    inputs:
      testResultsFiles: '**/nodeTest-results.xml' 
      testRunTitle: 'Node.js Test Results'
      mergeTestResults: true
      publishRunAttachments: true


  - script: |
      echo "Test run completed!"
    displayName: 'Post-Test Cleanup and Notification'